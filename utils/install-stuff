#!/bin/bash

########################################
# Add repositories to apt sources & update

# Dropbox
if ! grep Dropbox /etc/apt/sources.list
then
  echo '' >> /etc/apt/sources.list
  echo '# Dropbox' >> /etc/apt/sources.list
  echo "deb [arch=i386,amd64] http://linux.dropbox.com/ubuntu `lsb_release -cs` main" >> /etc/apt/sources.list
  apt-key adv --keyserver pgp.mit.edu --recv-keys 1C61A2656FB57B7E4DE0F4C1FC918B335044912E
fi

# KeePassX
if [[ -z "`find /etc/apt/sources.list.d/ | grep eugenesan`" ]]
then
  sudo add-apt-repository -y ppa:eugenesan/ppa
fi

# Docker
if ! grep Docker /etc/apt/sources.list
then
  echo '' >> /etc/apt/sources.list
  echo '# Docker' >> /etc/apt/sources.list
  echo "deb [arch=amd64] https://download.docker.com/linux/ubuntu `lsb_release -cs` stable" >> /etc/apt/sources.list
  curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
fi

apt-get -y update

########################################
# Install everything

apt install -y \
  ca-certificates \
  apt-transport-https \
  software-properties-common \
  vim \
  git \
  curl \
  compizconfig-settings-manager \
  python-gpgme \
  dropbox \
  keepassx \
  docker-ce


apt-get -y upgrade && apt-get -y autoremove

########################################
# Vim setup

# This folder will store our temporary backup files
mkdir -p ~/.vimtmp

# folders to store plugins
mkdir -p ~/.vim/autoload
mkdir -p ~/.vim/bundle

# https://github.com/tpope/vim-pathogen
curl -LSso ~/.vim/autoload/pathogen.vim https://tpo.pe/pathogen.vim

cd ~/.vim/bundle
[[ -d syntastic ]] || git clone -q --depth=1 https://github.com/vim-syntastic/syntastic.git
[[ -d vim-javascript ]] || git clone -q https://github.com/pangloss/vim-javascript.git
[[ -d vim-jsx ]] || git clone -q https://github.com/mxw/vim-jsx.git
[[ -d nerdtree ]] || git clone https://github.com/scrooloose/nerdtree.git

