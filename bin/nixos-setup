#! /usr/bin/env bash

# Get path to this etc project dir
etc=$( cd "$( dirname "${BASH_SOURCE[0]}" )/.." >/dev/null 2>&1 && pwd )

nix run --no-write-lock-file --impure github:nix-community/home-manager -- switch --flake "$etc"
sudo nixos-rebuild switch --flake "$etc" -L
home-manager switch --flake "$etc"
